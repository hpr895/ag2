window.Sticksy=function(){function c(a,b){if(!a)throw Error("You have to specify the target element");if("string"!==typeof a&&!(a instanceof Element))throw Error("Expected a string or element, but got: "+Object.prototype.toString.call(a));var d=f.findElement(a);if(!d)throw Error("Cannot find target element: "+a);var e=d.parentNode;if(!e)throw Error("Cannot find container of target element: "+a);b=b||{};this._props={containerEl:e,targetEl:d,topSpacing:b.topSpacing||0,enabled:b.enabled||!0,listen:b.listen||
!1};this.onStateChanged=null;this.nodeRef=d;this._initialize()}c.instances=[];c.enabledInstances=[];c.prototype._initialize=function(){var a=this;this.state="static";this._stickyNodes=[];this._dummyNodes=[];for(var b=this._props.targetEl;b;){var d=b.cloneNode(!0);d.style.visibility="hidden";d.style.pointerEvents="none";d.className+=" sticksy-dummy-node";d.removeAttribute("id");this._props.targetEl.parentNode.insertBefore(d,this._props.targetEl);this._stickyNodes.push(b);this._dummyNodes.push(d);b=
b.nextElementSibling}this._stickyNodesHeight=0;this._limits={top:0,bottom:0};this._isListening=!1;this._props.containerEl.style.position="relative";this._shouldCollapseMargins=-1===getComputedStyle(this._props.containerEl).display.indexOf("flex");this._props.listen&&(this._mutationObserver=new MutationObserver(function(){a.hardRefresh()}),this._startListen());c.instances.push(this);this._props.enabled&&c.enabledInstances.push(this);this.hardRefresh()};c.prototype._startListen=function(){this._props.listen&&
!this._isListening&&(this._mutationObserver.observe(this._props.containerEl,{attributes:!0,characterData:!0,childList:!0,subtree:!0}),this._isListening=!0)};c.prototype._stopListen=function(){this._props.listen&&this._isListening&&(this._mutationObserver.disconnect(),this._isListening=!1)};c.prototype._calcState=function(a){return a<this._limits.top?"static":a>=this._limits.bottom?"stuck":"fixed"};c.prototype._updateStickyNodesHeight=function(){this._stickyNodesHeight=f.getComputedBox(this._stickyNodes[this._stickyNodes.length-
1]).bottomWithMargin-f.getComputedBox(this._stickyNodes[0]).topWithMargin};c.prototype._updateLimits=function(){var a=this._stickyNodes,b=f.getComputedBox(this._props.containerEl);this._limits={top:f.getComputedBox(a[0]).topWithMargin-this._props.topSpacing,bottom:b.bottom-b.paddingBottom-this._props.topSpacing-this._stickyNodesHeight}};c.prototype._applyState=function(a){"static"===a?(this._resetElements(this._stickyNodes),this._disableElements(this._dummyNodes)):(this._fixElementsSize(this._stickyNodes),
"fixed"===a?this._fixElements(this._stickyNodes):this._stuckElements(this._stickyNodes),this._enableElements(this._dummyNodes))};c.prototype.refresh=function(){var a=this._calcState(window.pageYOffset,this._limits);if(a!==this.state&&(this.state=a,this._stopListen(),this._applyState(a),this._startListen(),"function"===typeof this.onStateChanged))this.onStateChanged(a)};c.prototype.hardRefresh=function(){this._stopListen();var a=this.state;this.state="static";this._applyState(this.state);this._fixElementsSize(this._stickyNodes);
this._updateStickyNodesHeight();this._updateLimits();this.state=this._calcState(window.pageYOffset,this._limits);this._applyState(this.state);this._startListen();if("function"===typeof this.onStateChanged&&a!==this.state)this.onStateChanged(this.state)};c.prototype.enable=function(){this._props.enabled=!0;c.enabledInstances.push(this);this.hardRefresh()};c.prototype.disable=function(){this._props.enabled=!1;this.state="static";this._applyState(this.state);c.enabledInstances.splice(c.enabledInstances.indexOf(this),
1)};c.prototype._fixElements=function(a){for(var b=0,d=this._props.topSpacing,e=0;e<a.length;e++){var h=a[e],g=f.getComputedBox(h);b=this._shouldCollapseMargins?Math.max(0,b-g.marginTop):b;h.style.position="fixed";h.style.top=d+b+"px";h.style.bottom="";d+=g.height+g.marginTop+b;b=g.marginBottom}};c.prototype._stuckElements=function(a){for(var b=0,d=f.getComputedBox(this._props.containerEl).paddingBottom,e=a.length-1;0<=e;e--){var h=a[e],g=f.getComputedBox(h);b=this._shouldCollapseMargins?Math.max(0,
b-g.marginBottom):b;h.style.position="absolute";h.style.top="auto";h.style.bottom=d+b+"px";d+=g.height+g.marginBottom+b;b=g.marginTop}};c.prototype._resetElements=function(a){a.forEach(function(b){b.style.position="";b.style.top="";b.style.bottom="";b.style.height="";b.style.width=""})};c.prototype._disableElements=function(a){a.forEach(function(b){b.style.display="none"})};c.prototype._enableElements=function(a){for(var b=0;b<a.length;b++)a[b].style.display=getComputedStyle(this._stickyNodes[b]).display};
c.prototype._fixElementsSize=function(){for(var a=0;a<this._stickyNodes.length;a++){var b=this._stickyNodes[a],d=getComputedStyle(b);b.style.width=d.width;b.style.height=d.height}};c.refreshAll=function(){for(var a=0;a<c.enabledInstances.length;a++)c.enabledInstances[a].refresh()};c.hardRefreshAll=function(){for(var a=0;a<c.enabledInstances.length;a++)c.enabledInstances[a].hardRefresh()};c.enableAll=function(){c.enabledInstances=c.instances.slice();this.hardRefreshAll()};c.disableAll=function(){for(var a=
c.enabledInstances.slice(),b=0;b<a.length;b++)c.enabledInstances[b].disable();c.enabledInstances=[]};c.initializeAll=function(a,b,d){if("undefined"===typeof a)throw Error("'target' parameter is undefined");var e=[];a instanceof Element?e=[a]:"undefined"!==typeof a.length&&0<a.length&&a[0]instanceof Element?e="function"===typeof a.get?a.get():a:"string"===typeof a&&(e=document.querySelectorAll(a)||[]);var h=[],g=[];e.forEach(function(k){-1===h.indexOf(k.parentNode)&&(h.push(k.parentNode),g.push(k))});
if(!d&&!g.length)throw Error("There are no elements to initialize");return g.map(function(k){return new c(k,b)})};window.addEventListener("scroll",c.refreshAll);window.addEventListener("resize",c.hardRefreshAll);var f={parseNumber:function(a){return parseFloat(a)||0},findElement:function(a,b){b||(b=document);return"string"===typeof a?b.querySelector(a):a instanceof Element?a:void 0},getComputedBox:function(a){var b=a.getBoundingClientRect();a=getComputedStyle(a);return{height:b.height,width:b.width,
top:window.pageYOffset+b.top,bottom:window.pageYOffset+b.bottom,marginTop:f.parseNumber(a.marginTop),marginBottom:f.parseNumber(a.marginBottom),paddingTop:f.parseNumber(a.paddingTop),paddingBottom:f.parseNumber(a.paddingBottom),topWithMargin:window.pageYOffset+b.top-f.parseNumber(a.marginTop),bottomWithMargin:window.pageYOffset+b.bottom+f.parseNumber(a.marginBottom)}}};return c}();var jQueryPlugin=window.$||window.jQuery||window.Zepto;
jQueryPlugin&&(jQueryPlugin.fn.sticksy=function(c){return window.Sticksy.initializeAll(this,c)});